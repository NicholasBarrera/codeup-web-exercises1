<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Weather Map</title>
	<!-- bootstrap cdn -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<!-- mapbox css -->
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.js"></script>
     <style>
     /*	mapox css styling */
  
        #map {
          /*  the width and height may be set to any size */

            width: 1500px;
            height: 700px;
            position: relative;
         
        }

        .mapboxgl-map {
        	visibility: visible;
        }
    </style>
 
</head>
<body>
<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
<script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js"></script>
<link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css" type="text/css">
<script src="js/mapbox-geocoder-utils.js"></script>

<script src="js/keys.js"></script>


	<nav class="d-flex justify-content-around bg-primary text-white">
		<div class="">
			<h3>Weather App</h3>
		</div>
		<div>
			<h3 id="current-city">Current City: </h3>
		</div>
		<!-- weather app nav bar  -->

	</nav>

	<main>
<!--		add ids for date, temp, description to each day-->
		<section class="d-flex justify-content-between">
			<!-- cards for weather forecast -->
			<div id="forecast1" class="card d-flex-column">

			</div>
			<div id="forecast2" class="card d-flex flex-column">

			</div>
			<div id="forecast3" class="card d-flex flex-column">


			</div>
			<div id="forecast4" class="card d-flex flex-column">


			</div>
			<div id="forecast5" class="card d-flex flex-column">

			</div>
		</section>
		<br>
		<section>
			<input class="w-100" type="text" id="searchPlaces" placeholder="Enter a location">
			<button type="button" class="btn btn-primary text-white w-100" id="searchPlacesButton">Get Your 5-day Forecast</button>
		</section>
		<section class="row">
			<!-- mapbox map -->
			<div class="visible" id="map"></div>
			<div class="coords"></div>
		</section>
	</main>

<!--<script>-->
<!--	$(function(){-->
<!--		// mapbox geocoder-->
<!--		mapboxgl.accessToken = MAPBOX_TOKEN;-->
<!--		var map = new mapboxgl.Map({-->
<!--			container: 'map',-->
<!--			style: 'mapbox://styles/mapbox/streets-v9',-->
<!--			zoom: 11,//start zoom-->
<!--			center: [-96.318120, 32.798940]//start pos-->
<!--		});-->

<!--		var marker = new mapboxgl.Marker({-->
<!--			draggable: true-->
<!--		})-->
<!--				.setLngLat([-96.4916, 32.7252])-->
<!--				.addTo(map);-->

<!--		function onDragEnd() {-->
<!--			var lngLat = marker.getLngLat();-->

<!--			console.log(lngLat);-->
<!--			getWeather(lngLat.lat, lngLat.lng);-->
<!--			reverseGeocode({lng: -96.4861, lat: 33.4260}, mapboxToken).then(function(results) {-->
<!--				//address for The Alamo-&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
<!--				console.log(results);-->
<!--				$("#location").html(results);-->

<!--			});-->
<!--		}-->

<!--		// mapbox user search feature-->
<!--		$('#searchPlacesButton').on("click", function() {-->
<!--			$.get("https://api.openweathermap.org/data/2.5/forecast?", {-->
<!--				APPID: OPEN_WEATHER_TOKEN,-->
<!--				q: $('#searchPlaces').val(),-->
<!--				units: "imperial",-->

<!--			}).done(function (data) {-->
<!--				var dailyData = []-->
<!--				for (let i = 0; i < data.list.length; i += 8) {-->
<!--					dailyData.push(data.list[i])-->
<!--				}-->
<!--				console.log(dailyData);-->

<!--				console.log(dailyWeather)-->
<!--				var day = []-->
<!--				for (var i = 0; i <= 5; i++) {-->


<!--					day.push({-->

<!--						tempH: dailyData.main.temp_max.toFixed(0),-->
<!--						tempL: dailyData.main.temp_min.toFixed(0),-->
<!--						weatherIcon: dailyData.weather[0].icon,-->
<!--						description: dailyData.weather[0].description,-->
<!--						weatherCondition: dailyData.weather[0].main-->

<!--					});-->
<!--				}-->

<!--					var daily;-->
<!--					switch (day[i]) {-->
<!--						case day[0]:-->
<!--							daily = $('#card-one');-->
<!--							break;-->
<!--						case day[1]:-->
<!--							daily = $('#card-two');-->
<!--							break;-->
<!--						case day[2]:-->
<!--							daily = $('#card-three');-->
<!--							break;-->
<!--						case day[3]:-->
<!--							daily = $('#card-four');-->
<!--							break;-->
<!--						case day[4]:-->
<!--							daily = $('#card-five');-->
<!--							break;-->
<!--					}-->

<!--				});-->

<!--					$(daily).html(-->
<!--							"<img src=\"" + day[i].WeatherIcon + "\" className=\"card-img-top\" alt=\"...\">" +-->
<!--							"<div className=\"card-body\">" +-->
<!--							"<h5 className=\"card-title\">" + "Condition: " + day[i].description + "<hr>" + "Feels like: " + day[i].tempFeel + "</h5>" +-->
<!--							"<p className=\"card-text\">" + "High: " + day[i].tempH + "<hr>" + "Low: " + day[i].tempL + "</p>" +-->
<!--							"</div>" +-->
<!--							"<div className=\"card-footer\">" +-->
<!--							"<small className=\"text-muted\"></small>" +-->
<!--							"</div>"-->
<!--					)-->








<!--			// let dayOne = dailyData[0]-->
<!--			// 	let dayOneDate = dailyData[0].dt_txt;-->
<!--			// 	let dayOneMax = dailyData[0].main.temp_max-->
<!--			// 	let dayOneMin = dailyData[0].main.temp_min-->
<!--			// 	let dayOneIcon = dailyData[0].weather.icon-->
<!--			// 	let dayOneDesc = dailyData[0].weather.description-->
<!--			// 	let dayOneHum = dailyData[0].main.humidity-->
<!--			// 	let dayOneWind = dailyData[0].wind.speed-->
<!--			// 	let dayOnePress =dailyData[0].main.pressure-->
<!--			//-->
<!--			//-->
<!--			// let dayTwo = dailyData[1]-->
<!--			//-->
<!--			// 	let dayTwoDate = dailyData[1].dt_txt;-->
<!--			// 	let dayTwoMax = dailyData[1].main.temp_max-->
<!--			// 	let dayTwoMin = dailyData[1].main.temp_min-->
<!--			// 	let dayTwoIcon = dailyData[1].weather.icon-->
<!--			// 	let dayTwoDesc = dailyData[1].weather.description-->
<!--			// 	let dayTwoHum = dailyData[1].main.humidity-->
<!--			// 	let dayTwoWind = dailyData[1].wind.speed-->
<!--			// 	let dayTwoPress =dailyData[1].main.pressure-->
<!--			//-->
<!--			//-->
<!--			// let dayThree = dailyData[2]-->
<!--			//-->
<!--			// 	let dayThreeDate = dailyData[2].dt_txt;-->
<!--			// 	let dayThreeMax = dailyData[2].main.temp_max-->
<!--			// 	let dayThreeMin = dailyData[2].main.temp_min-->
<!--			// 	let dayThreeIcon = dailyData[2].weather.icon-->
<!--			// 	let dayThreeDesc = dailyData[2].weather.description-->
<!--			// 	let dayThreeHum = dailyData[2].main.humidity-->
<!--			// 	let dayThreeWind = dailyData[2].wind.speed-->
<!--			// 	let dayThreePress =dailyData[2].main.pressure-->
<!--			//-->
<!--			//-->
<!--			// let dayFour = dailyData[3]-->
<!--			//-->
<!--			// 	let dayFourDate = dailyData[3].dt_txt;-->
<!--			// 	let dayFourMax = dailyData[3].main.temp_max-->
<!--			// 	let dayFourMin = dailyData[3].main.temp_min-->
<!--			// 	let dayFourIcon = dailyData[3].weather.icon-->
<!--			// 	let dayFourDesc = dailyData[3].weather.description-->
<!--			// 	let dayFourHum = dailyData[3].main.humidity-->
<!--			// 	let dayFourWind = dailyData[3].wind.speed-->
<!--			// 	let dayFourPress =dailyData[3].main.pressure-->
<!--			//-->
<!--			//-->
<!--			// let dayFive = dailyData[4]-->
<!--			//-->
<!--			// 	let dayFiveDate = dailyData[4].dt_txt;-->
<!--			// 	let dayFiveMax = dailyData[4].main.temp_max-->
<!--			// 	let dayFiveMin = dailyData[4].main.temp_min-->
<!--			// 	let dayFiveIcon = dailyData[4].weather.icon-->
<!--			// 	let dayFiveDesc = dailyData[4].weather.description-->
<!--			// 	let dayFiveHum = dailyData[4].main.humidity-->
<!--			// 	let dayFiveWind = dailyData[4].wind.speed-->
<!--			// 	let dayFivePress =dailyData[4].main.pressure-->

<!--			// console.log(dayThree.weather[0].icon)-->



<!--		// var userInput = $('#searchPlaces').val()-->
<!--		// mapboxgl.accessToken = MAPBOX_TOKEN;-->
<!--		// var map = new mapboxgl.Map({-->
<!--		// 	container: 'map',-->
<!--		// 	style: 'mapbox://styles/mapbox/streets-v9',-->
<!--		// 	zoom: 11,//start zoom-->
<!--		// 	center:-->
<!--		});-->
<!--	});-->

<!--</script>-->

	<script>
		(function(){
		$().ready(function(){
			var d = new Date();
			var tz = Date();
			// console.log("yikes" + poop);
			//current weather
			$.get("http://api.openweathermap.org/data/2.5/weather", {
				APPID: OPEN_WEATHER_TOKEN,
				q: "Dallas, US",
				units: "imperial"
			}).done(function(data) {
				console.log(data.weather[0].main);

			});

			var markerExists = false;
			var marker;
			var destinationLat;
			var destinationLng;



			$('#searchPlacesButton').click(function (){

				$.get("https://api.openweathermap.org/data/2.5/forecast", {
					APPID: OPEN_WEATHER_TOKEN,
					lat: destinationLat,
					lon: destinationLng,
					units: "imperial",
					q: $('#searchPlaces').val()
				}).done(function(data){
					$('#searchPlaces').val("")
					var day = [];
					for (var i = 0; i < 6; i++) {
						// var temp = data.list[i].main.temp.toFixed(0);
						// var tempH = data.list[i].main.temp_max.toFixed(0);
						// var tempL = data.list[i].main.temp_min.toFixed(0);
						// var tempFeel = data.list[i].main.feels_like.toFixed(0);
						// var mainWeatherCondition = data.list[i].weather[0].main;
						day.push({
							temp: data.list[i].main.temp.toFixed(0),
							tempH: data.list[i].main.temp_max.toFixed(0),
							tempL: data.list[i].main.temp_min.toFixed(0),
							tempFeel: data.list[i].main.feels_like.toFixed(0),
							mainWeatherCondition: data.list[i].weather[0].main,
							description: data.list[i].weather[0].description,
							wind: data.list[i].wind.speed,
							weatherDate: data.list[i].lastupdate
						});

						var weatherForecast;
						switch (day[i]){
							case day[1]:
								weatherForecast = $('#forecast1')
								break;
							case day[2]:
								weatherForecast = $('#forecast2')
								break;
							case day[3]:
								weatherForecast = $('#forecast3')
								break;
							case day[4]:
								weatherForecast = $('#forecast4')
								break;
							case day[5]:
								weatherForecast = $('#forecast5')
								break;
						}
						$(weatherForecast).html(



								"<p className=\"day-one-temp\">" + "High: " + day[i].tempH  + "</p>" +
								"<p className=\"d\">" + "Low: " + day[i].tempL + "</p>" +
								"<hr>" +
								"<div className=\"day-one-desc\">" +
								day[i].description +
								day[i].wind +

								"</div>"


						)
					}
				});
			})

			mapboxgl.accessToken = MAPBOX_TOKEN;
			const map = new mapboxgl.Map({
				container: 'map', // container ID
				style: 'mapbox://styles/mapbox/streets-v11', // style URL
				center: [-96.7970, 32.7767], // starting position [lng, lat]
				zoom: 9 // starting zoom
			});

			geocode("Dallas, Texas", MAPBOX_TOKEN).then(function(result) {

				map.setCenter(result);
				map.setZoom(8);
			});




		});
	})();
</script>

</body>
</html>